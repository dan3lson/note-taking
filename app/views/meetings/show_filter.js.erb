var $ajax_container = $("#ajax-container");
var show_filter_partial = "<%= j render(partial: 'meetings/show_filter', locals: { meeting: @meeting, note_type: @note_type }) %>";
$ajax_container.empty();
$ajax_container.hide().html(show_filter_partial).fadeIn(400);
var index = 0;
var $current_meeting = $ajax_container.children()[index];
var num_meetings = $(".filtered-meeting").length;
var $prev_button = $(".fa-arrow-circle-left").parent();
var $next_button = $(".fa-arrow-circle-right").parent();

// if (num_meetings < 2) hide_footer();
if (index == 0) hide_prev_button();

$prev_button.click(function() {
	show_prev_meeting();
	show_next_button();
	reset_create_edit_note_container();
	if (index == 0) hide_prev_button();
});

$next_button.click(function() {
	show_next_meeting();
	show_prev_button();
	reset_create_edit_note_container();
	if (index == num_meetings - 1) hide_next_button();
});

function show_next_button() {
	$next_button.show();
}

function hide_next_button() {
	$next_button.hide();
}

function show_prev_button() {
	$prev_button.children().show();
}

function hide_prev_button() {
	$prev_button.children().hide();
}

function hide_footer() {
	$(".navbar-footer").hide();
}

function show_footer() {
	$(".navbar-footer").show();
}

function reset_create_edit_note_container() {
	var default_text = create_elem("small", "medium-gray");
	default_text.append(
		"Tap 'Add', 'Update', or 'Delete' above to create, " +
		"edit, or remove a Pre, Current, or Post note for this meeting."
	)
	$(".create-edit-note-container").html(default_text)
}

function show_prev_meeting() {
	index = index - 1;
	var next_meeting_elem = $ajax_container.children()[index];
	$current_meeting = $(next_meeting_elem);
	$current_meeting.siblings()
									.not("footer")
									.not(".create-edit-note-container")
									.hide();
	$current_meeting.fadeIn(400);
}

function show_next_meeting() {
	index = index + 1;

	var partial = "<%#= j render(partial: 'meetings/filtered_meeting', locals: { meeting: @meeting, note_type: @note_type }) %>";
	var next_meeting = $ajax_container.empty().append(partial);

	next_meeting.hide().fadeIn(400);
}

function create_elem(elem, elem_class, elem_id) {
	elem_class = elem_class ||  null;
	elem_id = elem_id || null;

	return $("<" + elem + ">", { class: elem_class, id: elem_id });
}
